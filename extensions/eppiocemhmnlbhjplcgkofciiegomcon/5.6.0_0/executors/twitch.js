(()=>{function y(y,G,Z,Q,W=null){try{document.location.host;let g="detector",z=Z;!z&&W&&(z=W[0]?.type?W[0].type:null);let c={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"VIDEO_XHR_CANDIDATE",from:g,to:g.substring(0,g.length-2),content:{requestMethod:y,url:G,type:z,content:Q}};if(W&&W instanceof Promise)return void W.then((y=>{c.content.encodedPostBody=y,c.type="VIDEO_TWITCH_INSTREAM_DATA",window.postMessage(c,"*")}));Q?.includes("streamPlaybackAccessToken")&&(c.type="VIDEO_TWITCH_INSTREAM_DATA"),window.postMessage(c,"*")}catch(y){}}let G=XMLHttpRequest.prototype.open,Z=XMLHttpRequest.prototype.send,Q=fetch;XMLHttpRequest.prototype.open=function(){this.requestMethod=arguments[0],G.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){const G=Object.assign(arguments,{});let Q=this.onreadystatechange;return this.onreadystatechange=function(){if(4!==this.readyState||function(y){const G=document.querySelector("script[data-bis-config]")?JSON.parse(document.querySelector("script[data-bis-config]").getAttribute("data-bis-config")):null;return!!G&&G.some((G=>y.includes(G)))}(this.responseURL)||y(this.requestMethod,this.responseURL,this.getResponseHeader("content-type"),this.response,G),Q)return Q.apply(this,arguments)},Z.apply(this,arguments)},fetch=function(){const G=arguments;let Z=arguments[0]instanceof Request?arguments[0].url:arguments[0];const W=arguments[0]instanceof Request?arguments[0].method:arguments[1]?.method?arguments[1].method:"GET",g="POST"===W?arguments[1].body:null;return"object"==typeof Z&&Z.href&&(Z=Z.href),new Promise(((z,c)=>{Q.apply(this,G).then((function(G){if(G.body instanceof ReadableStream){const Q=G.headers.get("content-type"),z=G.json;G.json=function(){return new Promise(((c,A)=>{z.apply(this,arguments).then((function(z){0!==G.url.search(/data:application\/json;base64/)&&y(W,Z,Q,JSON.stringify(z),g),c(z)})).catch((function(y){A(y)}))}))};const c=G.text;G.text=function(){return new Promise(((z,A)=>{c.apply(this,arguments).then((function(c){0!==G.url.search(/data:application\/json;base64/)&&y(W,Z,Q,c,g),z(c)})).catch((function(y){A(y)}))}))},new RegExp("video-edge.*.ts$").test(Z)&&"POST"===W&&g?.arrayBuffer&&y(W,Z,g.type,null,g.text())}z.apply(this,arguments)})).catch((function(y){c.apply(this,arguments)}))}))}})();