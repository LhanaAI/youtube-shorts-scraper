(()=>{const y=(()=>{const y=sessionStorage.getItem("bis_data");if(null!==y){return JSON.parse(y)}return null})(),G=y?.config?`${y.id}_t`:null,Z=y?.config?.aiMessagesConfig?.META_AI||{},{PARSERS:Q=[],CHATBOT_NAME:W=""}=Z;ParserProcessors={XMLHttpRequest:function(y){let G=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(...Z){const Q=Z[0],W=this;return W.addEventListener("readystatechange",(function(){if(4===W.readyState&&W.status>=200&&W.status<300){const{message:G,sessionId:Z}=g(Q,y.SEND_MESSAGE);G&&Z&&z(W.responseText,y.RECEIVED_MESSAGE,Z)}})),G.call(this,...Z)}}};const g=(y,G)=>{const{MESSAGE_LIMIT:Z=1e4,DATA_QUERY:Q="",MESSAGE_QUERY:W=[],SESSION_ID_QUERY:g=[]}=G;let z=null,p=null;if("string"==typeof y&&y.includes(`${Q}=`)){z=new URLSearchParams(y).get(Q)}if(y instanceof FormData&&(z=y.get(Q)),z)try{p=JSON.parse(z)}catch(y){}if(p){const y=c(W,p),G=c(g,p);if(G&&y)return A(y,Z,G),{message:y,sessionId:G}}return{}},z=(y,G,Z)=>{try{const{MESSAGE_LIMIT:Q=3e4,DATA_FILTER:W="",MESSAGE_QUERY:g=[]}=G,z=y.split("\n").filter((y=>y.trim().startsWith(W))),p=z[z.length-1],K=JSON.parse(p),m=c(g,K);m&&A(m,Q,Z,"system")}catch(y){}},c=(y,G)=>y.reduce(((y,G)=>y?"object"==typeof y?y[G]:y:null),G),A=(y,G,Z,Q)=>{if(Z&&y){const W=p(y,G,Z,Q);W&&K(W)}},p=function(y,G,Z,Q="user"){return{chatbotName:W,messageType:Q,sessionId:Z,messageLength:y.length,messageText:y.trim().slice(0,G)}},K=y=>{try{let Z={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"META_AI_DATA",from:G,to:G.substring(0,G.length-2),content:y};window.postMessage(Z)}catch(y){}};for(let y of Q)y.USE&&ParserProcessors[y.TYPE](y)})();