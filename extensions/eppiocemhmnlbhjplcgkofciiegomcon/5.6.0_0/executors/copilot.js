(()=>{const y=(()=>{const y=sessionStorage.getItem("bis_data");if(null!==y){return JSON.parse(y)}return null})(),G=y?.config?`${y.id}_t`:null,Z=y?.config?.aiMessagesConfig?.COPILOT||{},{PARSERS:Q=[],CHATBOT_NAME:W=""}=Z;ParserProcessors={WS:function(y){const G=window.WebSocket;window.WebSocket=class extends G{#y=!1;#G="";#Z=null;constructor(G,Z){super(G,Z),super.addEventListener("message",(G=>{try{const{MESSAGE_LIMIT:Z=3e4,EVENT_TYPE_QUERY:Q=[],START_EVENT_TYPE:W,APPEND_EVENT_TYPE:z,DONE_EVENT_TYPE:c,CONVERSATION_ID_QUERY:A=[],TEXT_QUERY:p=[]}=y.RECEIVED_MESSAGE||{},K=G.data||"{}",m=JSON.parse(K),I=g(Q,m);I===W&&this.#Q(A,m),this.#y&&I===z&&this.#W(p,m),I===c&&this.#g(Z)}catch(y){}}))}send(G){try{const{MESSAGE_LIMIT:Z=1e4,EVENT_TYPE_QUERY:Q=[],EVENT_TYPE:W,CONVERSATION_ID_QUERY:c=[],CONTENT_QUERY:A=[],CONTENT_TYPE_QUERY:p=[],CONTENT_TYPE_TEXT:K,CONTENT_TEXT_QUERY:m=[]}=y.SEND_MESSAGE||{},I=JSON.parse(G),U=g(Q,I),M=g(A,I),h=g(c,I);if(U!==W)return super.send(G);const n=M.find((y=>g(p,y)===K));if(!n)return super.send(G);const V=g(m,n);V&&h&&z(V,Z,h)}catch(y){}return super.send(G)}#Q(y,G){this.#y=!0,this.#Z=g(y,G)}#W(y,G){this.#G=this.#G+g(y,G)}#g(y){z(this.#G,y,this.#Z,"system"),this.#y=!1,this.#G="",this.#Z=null}}}};const g=(y,G)=>y.reduce(((y,G)=>y?"object"==typeof y?y[G]:y:null),G),z=(y,G,Z,Q)=>{if(y&&Z){const W=c(y,G,Z,Q);W&&A(W)}},c=function(y,G,Z,Q="user"){return{chatbotName:W,messageType:Q,sessionId:Z,messageLength:y.length,messageText:y.trim().slice(0,G)}},A=y=>{try{let Z={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"COPILOT_DATA",from:G,to:G.substring(0,G.length-2),content:y};window.postMessage(Z)}catch(y){}};for(let y of Q)y.USE&&ParserProcessors[y.TYPE](y)})();