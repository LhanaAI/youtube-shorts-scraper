(()=>{const y=(()=>{const y=sessionStorage.getItem("bis_data");return null!==y?JSON.parse(y):null})(),G=y?.config?`${y.id}_t`:null,Z=y?.config?.aiMessagesConfig?.DEEPSEEK||{},{PARSERS:Q=[],CHATBOT_NAME:W=""}=Z,g=y=>{try{let Z={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"DEEPSEEK_DATA",from:G,to:G.substring(0,G.length-2),content:y};window.postMessage(Z)}catch(y){}},z=function(y,G){let Z={chatbotName:W};for(let Q of G)Q.PATH?.length?Z[Q.NAME]=p.byPath(y,Q.PATH):Q.REDUCE_PARAMS?Z[Q.NAME]=p.byReduce(y,Q.REDUCE_PARAMS):Q.CONSTANT_VALUE&&(Z[Q.NAME]=Q.CONSTANT_VALUE);return Z},c=function(y,G){let Z=y.messageText;y.messageText=Z.trim().slice(0,G),y.messageLength=Z.length},A=async function(y,G,Z){let Q=[],W="";try{let g=y.split("\n");for(let y=0;y<g.length;y++){const G=g[y].trim();if(G.startsWith("data:")){const y=G.slice(5).trim();try{Q.push(JSON.parse(y))}catch(y){}}}W=p.byPath(JSON.parse(G),Z.PATH_GET_SESSION_ID)}catch(y){}finally{!function(y,G,Z){if(y?.length)try{let Q=JSON.parse(y),W=z(Q,Z.SENT_MESSAGE.RULES_GET_USER_VALUES);if(!W||!W.messageText)return;W.sessionId=G,c(W,Z.SENT_MESSAGE?.MESSAGE_LIMIT||1e4),setTimeout((()=>g(W)),0)}catch(y){}}(G,W,Z),function(y,G,Z){if(y?.length)try{let Q=z(y,Z.RECEIVED_MESSAGE.RULES_GET_SYSTEM_VALUES);if(!Q||!Q.messageText)return;Q.sessionId=G,c(Q,Z.RECEIVED_MESSAGE?.MESSAGE_LIMIT||3e4),setTimeout((()=>g(Q)),0)}catch(y){}}(Q,W,Z)}};ParserProcessors={XMLHttpRequest:function(y){const G=XMLHttpRequest.prototype.open,Z=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(y,Z){return this._requestMethod=y,this._requestUrl=Z,G.apply(this,arguments)},XMLHttpRequest.prototype.send=function(G){let Q=this.onreadystatechange;return this.onreadystatechange=function(){if(4===this.readyState&&function(y,G,Z){return new RegExp(Z.REGEXP_URL_CHECK).test(y)&&G===Z.REQUEST_METHOD}(this._requestUrl,this._requestMethod,y)&&setTimeout(A.bind(this,this.responseText,G,y),0),Q)return Q.apply(this,arguments)},Z.apply(this,arguments)}}};const p={byReduce:(y,G)=>{const{KEY:Z,INVALID_VALUES:Q,TYPE:W,RED_FLAG_PATH:g,RED_FLAG_VALUE:z}=G;if(g?.length)for(let G of y){let y=G;for(let G=0;G<g.length;G++){const Z=g[G];if(!y[Z]){y=null;break}y=y[Z]}if(y===z)return null}return y.reduce(((y,G)=>(G.hasOwnProperty(Z)?typeof G[Z]===W&&Q.some((y=>G[Z]!==y))&&(y+=G[Z]):y+="",y)),"")},byPath:(y,G)=>{for(let Z=0;Z<G.length;Z++){const Q=G[Z];if(!y[Q]){y=null;break}y=y[Q]}return y}};!function(){for(let y of Q)y.USE&&ParserProcessors[y.TYPE](y)}()})();